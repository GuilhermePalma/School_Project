name: 🚀 Deploy Site With FTP - Debug

on:
  # Executa quando ha Push ou Pull Request na Branch Develop
  push:
    branches: [ develop ]
  pull_request:
    branches: [ develop ]
    
  # Executa somente Manualmente
  workflow_dispatch:

# Tarefas à serem realizadas
jobs:
  web-deploy:
    # Configuração do Ambiente 
    # Referencia: https://github.com/gabrielfroes/github-actions-ftp
    name: 🎉 Deploy Site - Debug
    runs-on: [windows-latest]
    steps:
    
      # Obtem o Ultimo Commit
      - name: 🚚 Get Latest Code
        uses: actions/checkout@v2
      
      # Mudança na String Connection
      # https://stackoverflow.com/questions/60521929 e https://github.com/microsoft/variable-substitution/issues/14
      - name: ✒️ Set-Up Production String Connection
        uses: microsoft/variable-substitution@v1
        with:
          files: 'SchoolProject/Web.config'
        env:
          connection: ${{ secrets.CONNECTION_DATABASE }}
      
      # Deploy com FTP
      - name: 📂 Deploy FTP Files
        uses: SamKirkland/FTP-Deploy-Action@4.0.0
        with:
          server: ${{ secrets.FTP_HOST }}
          username: ${{ secrets.FTP_USER }}
          password: ${{ secrets.FTP_KEY }}
          server-dir: ${{ secrets.FTP_WEBPATH }}
